<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Reducing Costs by Switching to Cheaper AWS Services | These Things Happen</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Reducing Costs by Switching to Cheaper AWS Services" />
<meta name="author" content="Dyana Rose" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I run a tiny website for tracking item prices in Guild Wars 2, gw2roar.com. I don’t run it for the money (it has 1 or 2 visitors per day), it’s simply a fun site that suits my needs." />
<meta property="og:description" content="I run a tiny website for tracking item prices in Guild Wars 2, gw2roar.com. I don’t run it for the money (it has 1 or 2 visitors per day), it’s simply a fun site that suits my needs." />
<link rel="canonical" href="http://dyanarose.github.io/blog/2022/06/08/reducing-costs-by-switching-to-cheaper-aws-services/" />
<meta property="og:url" content="http://dyanarose.github.io/blog/2022/06/08/reducing-costs-by-switching-to-cheaper-aws-services/" />
<meta property="og:site_name" content="These Things Happen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-08T12:11:11+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Reducing Costs by Switching to Cheaper AWS Services" />
<script type="application/ld+json">
{"description":"I run a tiny website for tracking item prices in Guild Wars 2, gw2roar.com. I don’t run it for the money (it has 1 or 2 visitors per day), it’s simply a fun site that suits my needs.","author":{"@type":"Person","name":"Dyana Rose"},"@type":"BlogPosting","url":"http://dyanarose.github.io/blog/2022/06/08/reducing-costs-by-switching-to-cheaper-aws-services/","headline":"Reducing Costs by Switching to Cheaper AWS Services","dateModified":"2022-06-08T12:11:11+01:00","datePublished":"2022-06-08T12:11:11+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://dyanarose.github.io/blog/2022/06/08/reducing-costs-by-switching-to-cheaper-aws-services/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://dyanarose.github.io/feed.xml" title="These Things Happen" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KWL38RC');</script>
    <!-- End Google Tag Manager -->
</head>
<body><!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KWL38RC"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --><header class="site-header">

  <div class="wrapper"><h1><a class="site-title" rel="author" href="/">These Things Happen</a></h1>
      
        <h2>fixing bugs and chewing bubblegum</h2>
      
  </div><nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>

      <div class="trigger"><a class="page-link" href="/blog/archives/">Archives</a><a class="page-link" href="/dateformats/">Date/time Cheat Sheet</a></div>
    </nav></header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Reducing Costs by Switching to Cheaper AWS Services</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-06-08T12:11:11+01:00" itemprop="datePublished">
        Jun 8, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I run a tiny website for tracking item prices in Guild Wars 2, <a href="http://www.gw2roar.com/">gw2roar.com</a>. I don’t run it for the money (it has 1 or 2 visitors per day), it’s simply a fun site that suits my needs.</p>

<p>Because it doesn’t make money, every penny of running cost comes out of my pocket. When I first started the site, it was all 12 month free tier AWS services so I didn’t care about cost and then I took part in an Alexa promotion that gave me a $100 credit against my monthly bill. All good things come to an end as they say. After I got notification that the promotion was ending, I started looking at how I could significantly reduce my costs.</p>

<h2 id="step-1-use-the-cost-explorer-to-find-the-high-cost-services">Step 1: Use the Cost Explorer to find the high cost services</h2>
<p>Open up <a href="console.aws.amazon.com/cost-management/home">Cost Management</a> and click on the Cost Explorer in the list on the left.</p>

<p>In this view you can explore the costs of each service you use.</p>

<p>I had two spikes in my cost explorer, Elasticache and RDS. Elasticache stores candlestick data per item per day for quick retrieval. RDS runs a postgres instance that stores the item price data retrieved every 30 minutes from the Guild Wars 2 API.</p>

<h2 id="step-2-imagine-your-site-without-the-high-cost-service">Step 2: Imagine your site without the high cost service</h2>
<p>What if Elasticache didn’t exist?</p>

<p>Calculating candlestick data on the fly is slow and the result never changes after a day is done and I used Elasticache to speed up loading times.</p>

<p>Ultimately I needed a quick, distributed cache I could query by item id and time. Elasticache isn’t the only service that provides that, I could move to nearly any distributed cache. My decision ultimately came down to cost.</p>

<h2 id="step-3-cost-up-the-changes">Step 3: Cost up the changes</h2>
<p>The AWS pricing calculator has gotten much easier to use over the past few years. Now that you can easily price by service there’s less room for missing out or adding in costs by mistake.</p>

<p>A 1 node, t2.micro <a href="https://calculator.aws/#/addService/ElastiCache">ElastiCache cluster costs about $12.41 per month</a>.</p>

<p>What would the price be if I switched to, say, DynamoDB?</p>

<p>DynamoDB is a bit more difficult to price, you need to know:</p>
<ul>
  <li>the size of your data</li>
  <li>the baseline read/write rates</li>
  <li>the peak read/write rates</li>
  <li>how long the peaks last</li>
  <li>what different options and features mean</li>
</ul>

<p>I used the information from ElastiCache to estimate the size of the data and the web statistics to estimate the read capacity. The write capacity was harder to estimate because it came from two sources.</p>

<p>A visitor could cause a write by loading the data for an item, but that would be at a much frequency lower than the number of users on the site. So the baseline write rate is very low.</p>

<p>At the end of every month a batch job calculates and loads all the data for the month into the cache. Given I knew how many items there were, and that the data needed to be loaded within 15 minutes (the timeout of a Lambda function), I could work out what the peak write rate would be.</p>

<p>Did I need:</p>
<ul>
  <li><a href="https://aws.amazon.com/blogs/aws/dynamodb-price-reduction-and-new-reserved-capacity-model/">reserved capacity</a>? no, that would drive up the cost and provide no benefit at a low rate of reads/writes</li>
  <li><a href="https://aws.amazon.com/dynamodb/pricing/on-demand/">on-demand capacity</a>? It’s nice in theory to pay for what you use, but in practice it would be more expensive for my site than using <a href="https://aws.amazon.com/dynamodb/pricing/provisioned/">provisioned capacity</a> and auto-scaling.</li>
</ul>

<p>With everything in the calculator, AWS predicted a cost of about $3.20 per month. However, the calculator doesn’t take into account the <a href="https://aws.amazon.com/free/?all-free-tier.sort-by=item.additionalFields.SortRank&amp;all-free-tier.sort-order=asc&amp;awsf.Free%20Tier%20Types=tier%23always-free&amp;awsf.Free%20Tier%20Categories=categories%23databases">“always free” alowances</a>, so switching to DynamoDB would actually bring my costs to 0.</p>

<h2 id="step-4-make-the-changes-and-evaluate">Step 4: Make the changes and evaluate</h2>
<p>The cost estimation is just an estimation. The real world can be different.</p>

<p>For example, with my first implementation of the switch to DynamoDB, I put some of the code into the same Lamdba function that called RDS. That function was running in the RDS VPC, and it’s quite simple to set up a VPC endpoint for DynamoDB. So easy that I missed that this would cost me <a href="https://aws.amazon.com/privatelink/pricing/">$0.01 per AZ per hour</a>.</p>

<p>Thankfully I saw the costs within the first few hours of creating the endpoint and was able to re-architect my functions.</p>

<p>Watching and evaluating the costs is essential to finding out fast if your estimates were wrong.</p>

<h2 id="step-5-repeat-from-step-1">Step 5: Repeat from Step 1</h2>
<p>Keep hunting for options and reducing costs until you’re satisfied.</p>

  </div><a class="u-url" href="/blog/2022/06/08/reducing-costs-by-switching-to-cheaper-aws-services/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/dyanarose" target="_blank" title="dyanarose"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/dyanarose" target="_blank" title="dyanarose"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
