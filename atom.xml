<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[These Things Happen]]></title>
  <link href="http://dyanarose.github.io/atom.xml" rel="self"/>
  <link href="http://dyanarose.github.io/"/>
  <updated>2016-04-10T15:52:01+01:00</updated>
  <id>http://dyanarose.github.io/</id>
  <author>
    <name><![CDATA[Dyana Rose]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Understanding the Different Sparl SQL DataTypes]]></title>
    <link href="http://dyanarose.github.io/blog/2016/04/09/understanding-the-different-sparl-sql-datatypes/"/>
    <updated>2016-04-09T12:57:06+01:00</updated>
    <id>http://dyanarose.github.io/blog/2016/04/09/understanding-the-different-sparl-sql-datatypes</id>
    <content type="html"><![CDATA[<p>Exploring how different DataTypes in Spark SQL are imported from line delimited json.</p>

<p>The only one I really can&rsquo;t get working yet is the CalendarIntervalType.</p>

<p>Looking at the Spark source files <a href="https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/literals.scala">literals.scala</a> and <a href="https://github.com/apache/spark/blob/master/common/unsafe/src/main/java/org/apache/spark/unsafe/types/CalendarInterval.java">CalendarInterval.java</a> I would assume that <code>CalendarInterval.fromString</code> is called with the value, however I&rsquo;m just getting nulls back currently when passing in a value like &lsquo;interval 2 days&rsquo; which when passed to <code>CalendarInterval.fromString</code> returns a non-null <code>CalendarInterval</code>.</p>

<p>Results:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
<span class='line-number'>429</span>
<span class='line-number'>430</span>
<span class='line-number'>431</span>
<span class='line-number'>432</span>
<span class='line-number'>433</span>
<span class='line-number'>434</span>
<span class='line-number'>435</span>
<span class='line-number'>436</span>
<span class='line-number'>437</span>
<span class='line-number'>438</span>
<span class='line-number'>439</span>
<span class='line-number'>440</span>
<span class='line-number'>441</span>
<span class='line-number'>442</span>
<span class='line-number'>443</span>
<span class='line-number'>444</span>
<span class='line-number'>445</span>
<span class='line-number'>446</span>
<span class='line-number'>447</span>
<span class='line-number'>448</span>
<span class='line-number'>449</span>
<span class='line-number'>450</span>
<span class='line-number'>451</span>
<span class='line-number'>452</span>
<span class='line-number'>453</span>
<span class='line-number'>454</span>
<span class='line-number'>455</span>
<span class='line-number'>456</span>
<span class='line-number'>457</span>
<span class='line-number'>458</span>
<span class='line-number'>459</span>
<span class='line-number'>460</span>
<span class='line-number'>461</span>
<span class='line-number'>462</span>
<span class='line-number'>463</span>
<span class='line-number'>464</span>
<span class='line-number'>465</span>
<span class='line-number'>466</span>
<span class='line-number'>467</span>
<span class='line-number'>468</span>
<span class='line-number'>469</span>
<span class='line-number'>470</span>
<span class='line-number'>471</span>
<span class='line-number'>472</span>
<span class='line-number'>473</span>
<span class='line-number'>474</span>
<span class='line-number'>475</span>
<span class='line-number'>476</span>
<span class='line-number'>477</span>
<span class='line-number'>478</span>
<span class='line-number'>479</span>
<span class='line-number'>480</span>
<span class='line-number'>481</span>
<span class='line-number'>482</span>
<span class='line-number'>483</span>
<span class='line-number'>484</span>
<span class='line-number'>485</span>
<span class='line-number'>486</span>
<span class='line-number'>487</span>
<span class='line-number'>488</span>
<span class='line-number'>489</span>
<span class='line-number'>490</span>
<span class='line-number'>491</span>
<span class='line-number'>492</span>
<span class='line-number'>493</span>
<span class='line-number'>494</span>
<span class='line-number'>495</span>
<span class='line-number'>496</span>
<span class='line-number'>497</span>
<span class='line-number'>498</span>
<span class='line-number'>499</span>
<span class='line-number'>500</span>
<span class='line-number'>501</span>
<span class='line-number'>502</span>
<span class='line-number'>503</span>
<span class='line-number'>504</span>
<span class='line-number'>505</span>
<span class='line-number'>506</span>
<span class='line-number'>507</span>
<span class='line-number'>508</span>
<span class='line-number'>509</span>
<span class='line-number'>510</span>
<span class='line-number'>511</span>
<span class='line-number'>512</span>
<span class='line-number'>513</span>
<span class='line-number'>514</span>
<span class='line-number'>515</span>
<span class='line-number'>516</span>
<span class='line-number'>517</span>
<span class='line-number'>518</span>
<span class='line-number'>519</span>
<span class='line-number'>520</span>
<span class='line-number'>521</span>
<span class='line-number'>522</span>
<span class='line-number'>523</span>
<span class='line-number'>524</span>
<span class='line-number'>525</span>
<span class='line-number'>526</span>
<span class='line-number'>527</span>
<span class='line-number'>528</span>
<span class='line-number'>529</span>
<span class='line-number'>530</span>
<span class='line-number'>531</span>
<span class='line-number'>532</span>
<span class='line-number'>533</span>
<span class='line-number'>534</span>
<span class='line-number'>535</span>
<span class='line-number'>536</span>
<span class='line-number'>537</span>
<span class='line-number'>538</span>
<span class='line-number'>539</span>
<span class='line-number'>540</span>
<span class='line-number'>541</span>
<span class='line-number'>542</span>
<span class='line-number'>543</span>
<span class='line-number'>544</span>
<span class='line-number'>545</span>
<span class='line-number'>546</span>
<span class='line-number'>547</span>
<span class='line-number'>548</span>
<span class='line-number'>549</span>
<span class='line-number'>550</span>
<span class='line-number'>551</span>
<span class='line-number'>552</span>
<span class='line-number'>553</span>
<span class='line-number'>554</span>
<span class='line-number'>555</span>
<span class='line-number'>556</span>
<span class='line-number'>557</span>
<span class='line-number'>558</span>
<span class='line-number'>559</span>
<span class='line-number'>560</span>
<span class='line-number'>561</span>
<span class='line-number'>562</span>
<span class='line-number'>563</span>
<span class='line-number'>564</span>
<span class='line-number'>565</span>
<span class='line-number'>566</span>
<span class='line-number'>567</span>
<span class='line-number'>568</span>
<span class='line-number'>569</span>
<span class='line-number'>570</span>
<span class='line-number'>571</span>
<span class='line-number'>572</span>
<span class='line-number'>573</span>
<span class='line-number'>574</span>
<span class='line-number'>575</span>
<span class='line-number'>576</span>
<span class='line-number'>577</span>
<span class='line-number'>578</span>
<span class='line-number'>579</span>
<span class='line-number'>580</span>
<span class='line-number'>581</span>
<span class='line-number'>582</span>
<span class='line-number'>583</span>
<span class='line-number'>584</span>
<span class='line-number'>585</span>
<span class='line-number'>586</span>
<span class='line-number'>587</span>
<span class='line-number'>588</span>
<span class='line-number'>589</span>
<span class='line-number'>590</span>
<span class='line-number'>591</span>
<span class='line-number'>592</span>
<span class='line-number'>593</span>
<span class='line-number'>594</span>
<span class='line-number'>595</span>
<span class='line-number'>596</span>
<span class='line-number'>597</span>
<span class='line-number'>598</span>
<span class='line-number'>599</span>
<span class='line-number'>600</span>
<span class='line-number'>601</span>
<span class='line-number'>602</span>
<span class='line-number'>603</span>
<span class='line-number'>604</span>
<span class='line-number'>605</span>
<span class='line-number'>606</span>
<span class='line-number'>607</span>
<span class='line-number'>608</span>
<span class='line-number'>609</span>
<span class='line-number'>610</span>
<span class='line-number'>611</span>
<span class='line-number'>612</span>
<span class='line-number'>613</span>
<span class='line-number'>614</span>
<span class='line-number'>615</span>
<span class='line-number'>616</span>
<span class='line-number'>617</span>
<span class='line-number'>618</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-------------- DecimalType --------------
</span><span class='line'>------- DecimalType Input
</span><span class='line'>{'decimal': 1.2345}
</span><span class='line'>{'decimal': 1}
</span><span class='line'>{'decimal': 234.231}
</span><span class='line'>{'decimal': Infinity}
</span><span class='line'>{'decimal': -Infinity}
</span><span class='line'>{'decimal': NaN}
</span><span class='line'>{'decimal': '1'}
</span><span class='line'>{'decimal': '1.2345'}
</span><span class='line'>{'decimal': null}
</span><span class='line'>
</span><span class='line'>------- DecimalType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- decimal: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-----------+
</span><span class='line'>|    decimal|
</span><span class='line'>+-----------+
</span><span class='line'>|     1.2345|
</span><span class='line'>|          1|
</span><span class='line'>|    234.231|
</span><span class='line'>| "Infinity"|
</span><span class='line'>|"-Infinity"|
</span><span class='line'>|      "NaN"|
</span><span class='line'>|          1|
</span><span class='line'>|     1.2345|
</span><span class='line'>|       null|
</span><span class='line'>+-----------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- DecimalType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- decimal: decimal(6,3) (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------+
</span><span class='line'>|decimal|
</span><span class='line'>+-------+
</span><span class='line'>|  1.235|
</span><span class='line'>|  1.000|
</span><span class='line'>|234.231|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>+-------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- BooleanType --------------
</span><span class='line'>------- BooleanType Input
</span><span class='line'>{'boolean': true}
</span><span class='line'>{'boolean': false}
</span><span class='line'>{'boolean': 'false'}
</span><span class='line'>{'boolean': 'true'}
</span><span class='line'>{'boolean': null}
</span><span class='line'>{'boolean': 1}
</span><span class='line'>{'boolean': 0}
</span><span class='line'>{'boolean': '1'}
</span><span class='line'>{'boolean': '0'}
</span><span class='line'>{'boolean': 'a'}
</span><span class='line'>
</span><span class='line'>------- BooleanType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- boolean: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------+
</span><span class='line'>|boolean|
</span><span class='line'>+-------+
</span><span class='line'>|   true|
</span><span class='line'>|  false|
</span><span class='line'>|  false|
</span><span class='line'>|   true|
</span><span class='line'>|   null|
</span><span class='line'>|      1|
</span><span class='line'>|      0|
</span><span class='line'>|      1|
</span><span class='line'>|      0|
</span><span class='line'>|      a|
</span><span class='line'>+-------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- BooleanType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- boolean: boolean (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------+
</span><span class='line'>|boolean|
</span><span class='line'>+-------+
</span><span class='line'>|   true|
</span><span class='line'>|  false|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>|   null|
</span><span class='line'>+-------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- ByteType --------------
</span><span class='line'>------- ByteType Input
</span><span class='line'>{'byte': 'a'}
</span><span class='line'>{'byte': 'b'}
</span><span class='line'>{'byte': 1}
</span><span class='line'>{'byte': 0}
</span><span class='line'>{'byte': 5}
</span><span class='line'>{'byte': null}
</span><span class='line'>
</span><span class='line'>------- ByteType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- byte: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+----+
</span><span class='line'>|byte|
</span><span class='line'>+----+
</span><span class='line'>|   a|
</span><span class='line'>|   b|
</span><span class='line'>|   1|
</span><span class='line'>|   0|
</span><span class='line'>|   5|
</span><span class='line'>|null|
</span><span class='line'>+----+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- ByteType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- byte: byte (nullable = true)
</span><span class='line'>
</span><span class='line'>+----+
</span><span class='line'>|byte|
</span><span class='line'>+----+
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|   1|
</span><span class='line'>|   0|
</span><span class='line'>|   5|
</span><span class='line'>|null|
</span><span class='line'>+----+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- CalendarIntervalType --------------
</span><span class='line'>------- CalendarIntervalType Input
</span><span class='line'>{'calendarInterval': 'interval 2 days'}
</span><span class='line'>{'calendarInterval': 'interval 1 week'}
</span><span class='line'>{'calendarInterval': 'interval 5 years'}
</span><span class='line'>{'calendarInterval': 'interval 6 months'}
</span><span class='line'>{'calendarInterval': 10}
</span><span class='line'>{'calendarInterval': 'interval a'}
</span><span class='line'>{'calendarInterval': null}
</span><span class='line'>
</span><span class='line'>------- CalendarIntervalType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- calendarInterval: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-----------------+
</span><span class='line'>| calendarInterval|
</span><span class='line'>+-----------------+
</span><span class='line'>|  interval 2 days|
</span><span class='line'>|  interval 1 week|
</span><span class='line'>| interval 5 years|
</span><span class='line'>|interval 6 months|
</span><span class='line'>|               10|
</span><span class='line'>|       interval a|
</span><span class='line'>|             null|
</span><span class='line'>+-----------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- CalendarIntervalType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- calendarInterval: calendarinterval (nullable = true)
</span><span class='line'>
</span><span class='line'>+----------------+
</span><span class='line'>|calendarInterval|
</span><span class='line'>+----------------+
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>|            null|
</span><span class='line'>+----------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- DateType --------------
</span><span class='line'>------- DateType Input
</span><span class='line'>{'date': '2016-04-24'}
</span><span class='line'>{'date': '0001-01-01'}
</span><span class='line'>{'date': '9999-12-31'}
</span><span class='line'>{'date': '2016-04-24 12:10:01'}
</span><span class='line'>{'date': 1461496201000}
</span><span class='line'>{'date': null}
</span><span class='line'>
</span><span class='line'>------- DateType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- date: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------------------+
</span><span class='line'>|               date|
</span><span class='line'>+-------------------+
</span><span class='line'>|         2016-04-24|
</span><span class='line'>|         0001-01-01|
</span><span class='line'>|         9999-12-31|
</span><span class='line'>|2016-04-24 12:10:01|
</span><span class='line'>|      1461496201000|
</span><span class='line'>|               null|
</span><span class='line'>+-------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- DateType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- date: date (nullable = true)
</span><span class='line'>
</span><span class='line'>+----------+
</span><span class='line'>|      date|
</span><span class='line'>+----------+
</span><span class='line'>|2016-04-24|
</span><span class='line'>|0001-01-01|
</span><span class='line'>|9999-12-31|
</span><span class='line'>|2016-04-24|
</span><span class='line'>|      null|
</span><span class='line'>|      null|
</span><span class='line'>+----------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- DoubleType --------------
</span><span class='line'>------- DoubleType Input
</span><span class='line'>{'double': 1.23456}
</span><span class='line'>{'double': 1}
</span><span class='line'>{'double': 1.7976931348623157E308}
</span><span class='line'>{'double': -1.7976931348623157E308}
</span><span class='line'>{'double': Infinity}
</span><span class='line'>{'double': -Infinity}
</span><span class='line'>{'double': NaN}
</span><span class='line'>{'double': '1'}
</span><span class='line'>{'double': '1.23456'}
</span><span class='line'>{'double': null}
</span><span class='line'>
</span><span class='line'>------- DoubleType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- double: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|              double|
</span><span class='line'>+--------------------+
</span><span class='line'>|             1.23456|
</span><span class='line'>|                   1|
</span><span class='line'>|1.797693134862315...|
</span><span class='line'>|-1.79769313486231...|
</span><span class='line'>|          "Infinity"|
</span><span class='line'>|         "-Infinity"|
</span><span class='line'>|               "NaN"|
</span><span class='line'>|                   1|
</span><span class='line'>|             1.23456|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- DoubleType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- double: double (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|              double|
</span><span class='line'>+--------------------+
</span><span class='line'>|             1.23456|
</span><span class='line'>|                 1.0|
</span><span class='line'>|1.797693134862315...|
</span><span class='line'>|-1.79769313486231...|
</span><span class='line'>|            Infinity|
</span><span class='line'>|           -Infinity|
</span><span class='line'>|                 NaN|
</span><span class='line'>|                null|
</span><span class='line'>|                null|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- FloatType --------------
</span><span class='line'>------- FloatType Input
</span><span class='line'>{'float': 1.23456}
</span><span class='line'>{'float': 1}
</span><span class='line'>{'float': 3.4028235E38}
</span><span class='line'>{'float': -3.4028235E38}
</span><span class='line'>{'float': Infinity}
</span><span class='line'>{'float': -Infinity}
</span><span class='line'>{'float': NaN}
</span><span class='line'>{'float': '1'}
</span><span class='line'>{'float': '1.23456'}
</span><span class='line'>{'float': null}
</span><span class='line'>
</span><span class='line'>------- FloatType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- float: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------------+
</span><span class='line'>|        float|
</span><span class='line'>+-------------+
</span><span class='line'>|      1.23456|
</span><span class='line'>|            1|
</span><span class='line'>| 3.4028235E38|
</span><span class='line'>|-3.4028235E38|
</span><span class='line'>|   "Infinity"|
</span><span class='line'>|  "-Infinity"|
</span><span class='line'>|        "NaN"|
</span><span class='line'>|            1|
</span><span class='line'>|      1.23456|
</span><span class='line'>|         null|
</span><span class='line'>+-------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- FloatType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- float: float (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------------+
</span><span class='line'>|        float|
</span><span class='line'>+-------------+
</span><span class='line'>|      1.23456|
</span><span class='line'>|          1.0|
</span><span class='line'>| 3.4028235E38|
</span><span class='line'>|-3.4028235E38|
</span><span class='line'>|     Infinity|
</span><span class='line'>|    -Infinity|
</span><span class='line'>|          NaN|
</span><span class='line'>|         null|
</span><span class='line'>|         null|
</span><span class='line'>|         null|
</span><span class='line'>+-------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- IntegerType --------------
</span><span class='line'>------- IntegerType Input
</span><span class='line'>{'integer': 1}
</span><span class='line'>{'integer': 2147483647}
</span><span class='line'>{'integer': -2147483648}
</span><span class='line'>{'integer': 2147483648}
</span><span class='line'>{'integer': '1'}
</span><span class='line'>{'integer': 1.23456}
</span><span class='line'>{'integer': '1.23456'}
</span><span class='line'>{'integer': null}
</span><span class='line'>
</span><span class='line'>------- IntegerType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- integer: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-----------+
</span><span class='line'>|    integer|
</span><span class='line'>+-----------+
</span><span class='line'>|          1|
</span><span class='line'>| 2147483647|
</span><span class='line'>|-2147483648|
</span><span class='line'>| 2147483648|
</span><span class='line'>|          1|
</span><span class='line'>|    1.23456|
</span><span class='line'>|    1.23456|
</span><span class='line'>|       null|
</span><span class='line'>+-----------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- IntegerType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- integer: integer (nullable = true)
</span><span class='line'>
</span><span class='line'>+-----------+
</span><span class='line'>|    integer|
</span><span class='line'>+-----------+
</span><span class='line'>|          1|
</span><span class='line'>| 2147483647|
</span><span class='line'>|-2147483648|
</span><span class='line'>|       null|
</span><span class='line'>|       null|
</span><span class='line'>|       null|
</span><span class='line'>|       null|
</span><span class='line'>|       null|
</span><span class='line'>+-----------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- LongType --------------
</span><span class='line'>------- LongType Input
</span><span class='line'>{'long': 1}
</span><span class='line'>{'long': 9223372036854775807}
</span><span class='line'>{'long': -9223372036854775808}
</span><span class='line'>{'long': '1'}
</span><span class='line'>{'long': 1.23456}
</span><span class='line'>{'long': '1.23456'}
</span><span class='line'>{'long': null}
</span><span class='line'>
</span><span class='line'>------- LongType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- long: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|                long|
</span><span class='line'>+--------------------+
</span><span class='line'>|                   1|
</span><span class='line'>| 9223372036854775807|
</span><span class='line'>|-9223372036854775808|
</span><span class='line'>|                   1|
</span><span class='line'>|             1.23456|
</span><span class='line'>|             1.23456|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- LongType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- long: long (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|                long|
</span><span class='line'>+--------------------+
</span><span class='line'>|                   1|
</span><span class='line'>| 9223372036854775807|
</span><span class='line'>|-9223372036854775808|
</span><span class='line'>|                null|
</span><span class='line'>|                null|
</span><span class='line'>|                null|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- MapType --------------
</span><span class='line'>------- MapType Input
</span><span class='line'>{'map': {'a_key': 'a value', 'b_key': 'b value'}}
</span><span class='line'>{'map': {'key': 1, 'key1': null}}
</span><span class='line'>{'map': null}
</span><span class='line'>
</span><span class='line'>------- MapType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- map: struct (nullable = true)
</span><span class='line'> |    |-- a_key: string (nullable = true)
</span><span class='line'> |    |-- b_key: string (nullable = true)
</span><span class='line'> |    |-- key: long (nullable = true)
</span><span class='line'> |    |-- key1: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|                 map|
</span><span class='line'>+--------------------+
</span><span class='line'>|[a value,b value,...|
</span><span class='line'>|  [null,null,1,null]|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- MapType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- map: map (nullable = true)
</span><span class='line'> |    |-- key: string
</span><span class='line'> |    |-- value: string (valueContainsNull = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|                 map|
</span><span class='line'>+--------------------+
</span><span class='line'>|Map(a_key -&gt; a va...|
</span><span class='line'>|Map(key -&gt; 1, key...|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- NullType --------------
</span><span class='line'>------- NullType Input
</span><span class='line'>{'null': null}
</span><span class='line'>{'null': true}
</span><span class='line'>{'null': false}
</span><span class='line'>{'null': 1}
</span><span class='line'>{'null': 0}
</span><span class='line'>{'null': '1'}
</span><span class='line'>{'null': '0'}
</span><span class='line'>{'null': 'a'}
</span><span class='line'>
</span><span class='line'>------- NullType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- null: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-----+
</span><span class='line'>| null|
</span><span class='line'>+-----+
</span><span class='line'>| null|
</span><span class='line'>| true|
</span><span class='line'>|false|
</span><span class='line'>|    1|
</span><span class='line'>|    0|
</span><span class='line'>|    1|
</span><span class='line'>|    0|
</span><span class='line'>|    a|
</span><span class='line'>+-----+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- NullType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- null: null (nullable = true)
</span><span class='line'>
</span><span class='line'>+----+
</span><span class='line'>|null|
</span><span class='line'>+----+
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>|null|
</span><span class='line'>+----+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- ShortType --------------
</span><span class='line'>------- ShortType Input
</span><span class='line'>{'short': 0}
</span><span class='line'>{'short': 1}
</span><span class='line'>{'short': 32767}
</span><span class='line'>{'short': -32768}
</span><span class='line'>{'short': 32768}
</span><span class='line'>{'short': 1.23456}
</span><span class='line'>{'short': '0'}
</span><span class='line'>{'short': '1'}
</span><span class='line'>{'short': '1.23456'}
</span><span class='line'>{'short': null}
</span><span class='line'>
</span><span class='line'>------- ShortType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- short: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------+
</span><span class='line'>|  short|
</span><span class='line'>+-------+
</span><span class='line'>|      0|
</span><span class='line'>|      1|
</span><span class='line'>|  32767|
</span><span class='line'>| -32768|
</span><span class='line'>|  32768|
</span><span class='line'>|1.23456|
</span><span class='line'>|      0|
</span><span class='line'>|      1|
</span><span class='line'>|1.23456|
</span><span class='line'>|   null|
</span><span class='line'>+-------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- ShortType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- short: short (nullable = true)
</span><span class='line'>
</span><span class='line'>+------+
</span><span class='line'>| short|
</span><span class='line'>+------+
</span><span class='line'>|     0|
</span><span class='line'>|     1|
</span><span class='line'>| 32767|
</span><span class='line'>|-32768|
</span><span class='line'>|  null|
</span><span class='line'>|  null|
</span><span class='line'>|  null|
</span><span class='line'>|  null|
</span><span class='line'>|  null|
</span><span class='line'>|  null|
</span><span class='line'>+------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>-------------- TimestampType --------------
</span><span class='line'>------- TimestampType Input
</span><span class='line'>{'timestamp': '2016-04-24'}
</span><span class='line'>{'timestamp': '2016-04-24 12:10:01'}
</span><span class='line'>{'timestamp': 1461496201000}
</span><span class='line'>{'timestamp': '0001-01-01'}
</span><span class='line'>{'timestamp': '9999-12-31'}
</span><span class='line'>{'timestamp': null}
</span><span class='line'>
</span><span class='line'>------- TimestampType Inferred Schema
</span><span class='line'>root
</span><span class='line'> |-- timestamp: string (nullable = true)
</span><span class='line'>
</span><span class='line'>+-------------------+
</span><span class='line'>|          timestamp|
</span><span class='line'>+-------------------+
</span><span class='line'>|         2016-04-24|
</span><span class='line'>|2016-04-24 12:10:01|
</span><span class='line'>|      1461496201000|
</span><span class='line'>|         0001-01-01|
</span><span class='line'>|         9999-12-31|
</span><span class='line'>|               null|
</span><span class='line'>+-------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>------- TimestampType Set Schema
</span><span class='line'>root
</span><span class='line'> |-- timestamp: timestamp (nullable = true)
</span><span class='line'>
</span><span class='line'>+--------------------+
</span><span class='line'>|           timestamp|
</span><span class='line'>+--------------------+
</span><span class='line'>|2016-04-24 00:00:...|
</span><span class='line'>|2016-04-24 12:10:...|
</span><span class='line'>|2016-04-24 12:10:...|
</span><span class='line'>|0001-01-01 00:00:...|
</span><span class='line'>|9999-12-31 00:00:...|
</span><span class='line'>|                null|
</span><span class='line'>+--------------------+
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Preventing Duplication When Creating Relationships in Neo4j]]></title>
    <link href="http://dyanarose.github.io/blog/2014/07/08/preventing-duplication-when-creating-relationships-in-neo4j/"/>
    <updated>2014-07-08T20:50:10+01:00</updated>
    <id>http://dyanarose.github.io/blog/2014/07/08/preventing-duplication-when-creating-relationships-in-neo4j</id>
    <content type="html"><![CDATA[<p>Creating relationships between known nodes using Cypher in Neo4j is simple.</p>

<pre><code>MATCH (p:Person), (e:Episode)
CREATE (p) - [:INTERVIEWED_IN] -&gt; (e)
</code></pre>

<p>But what it you don&rsquo;t know if one of the nodes exists? And further, what if you don&rsquo;t know if the relationship itself already exists?</p>

<ul>
<li>If the node doesn&rsquo;t exist, I want it to be created.</li>
<li>If the relationship doesn&rsquo;t exist, I want it to be created.</li>
<li>If both node and relationship exist, then nothing should be changed</li>
</ul>


<p>The simple scenario is of a set of Episode nodes and a set of Person nodes.</p>

<pre><code>CREATE (e:Episode {title:"foo", subtitle:"bar"})
return e
CREATE (p:Person {name:"Lynn Rose"})
return p
</code></pre>

<p>The Episode nodes are known to exist. The Person nodes may or may not exist.</p>

<p>My first attempts at getting this right in my working database were tragic failures.
For example, the following, while working as intended in a new 2.0.1 database, fails and causes duplicate person nodes in my working database. (Adding a unique constraint on person.name causes the statement to throw an exception rather than create a duplicate)</p>

<pre><code>MATCH (e:Episode {title: "foo"})
CREATE UNIQUE (e) &lt;- [:INTERVIEWED_IN] - (p:Person {name:"Lynn Rose"})
</code></pre>

<p>As I said, the duplication doesn&rsquo;t happen in a clean 2.0.1 database, so the problem must be with my working database.</p>

<ol>
<li>The database was originally created on Neo4j 1.9.3 and is now running under Neo4j 2.0.1</li>
<li>The nodes created before the release of 2.x use the old style indexes.</li>
</ol>


<p>But those facts aside, I still need to stop the duplication! So back to the <a href="http://docs.neo4j.org/chunked/stable/cypher-query-lang.html">Cypher documentation</a>.</p>

<p>The Cypher documents for <a href="http://docs.neo4j.org/chunked/stable/query-create-unique.html">CREATE UNIQUE</a>  specify the following in a call out box:</p>

<blockquote><p>  <a href="http://docs.neo4j.org/chunked/stable/query-merge.html">MERGE</a> might be what you want to use instead of CREATE UNIQUE</p></blockquote>

<p>It&rsquo;s MERGE that gives the ability to control what happens when a node is, or isn&rsquo;t, matched. It does this through the syntax of ON MATCH and ON CREATE.</p>

<p>Using MERGE and ON CREATE I can get a handle on an existing person node to be able to use in our relationship creation, thus preventing duplication of person nodes.</p>

<pre><code>MATCH (e:Episode {title: "foo"})
MERGE (p:Person {name: "Lynn Rose"})
ON CREATE SET p.firstname = "Lynn", p.surname = "Rose"
MERGE (e) &lt;- [:INTERVIEWED_IN] - (p)
</code></pre>

<p>But, we&rsquo;ve still got an issue here. This doesn&rsquo;t necessarily solve the problem of duplicating relationships.</p>

<p>In that call out box in the CREATE UNIQUE documentation, it goes on to say:</p>

<blockquote><p>  Note however, that MERGE doesn&rsquo;t give as strong guarantees for relationships being unique.</p></blockquote>

<p>So I take from this that I should use MERGE to prevent node duplication, but CREATE UNIQUE should be used to prevent relationship duplication.</p>

<pre><code>MATCH (e:Episode {title: "foo"})
MERGE (p:Person {name: "Lynn Rose"})
ON CREATE SET p.firstname = "Lynn", p.surname = "Rose"
CREATE UNIQUE (e) &lt;- [:INTERVIEWED_IN] - (p)
</code></pre>

<p>And here we are.</p>

<ul>
<li>If the node doesn&rsquo;t exist, it is created using MERGE ON CREATE.</li>
<li>If the relationship doesn&rsquo;t exist, it is created using CREATE UNIQUE.</li>
<li>If both node and relationship exist, then nothing is changed.</li>
</ul>

]]></content>
  </entry>
  
</feed>
